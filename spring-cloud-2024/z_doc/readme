mysql:
jdbc.driverClass=com.mysql.cj.jdbc.Driver
jdbc.url=jdbc:mysql://192.168.137.110:3306/cloud_2024?characterEncoding=utf-8&useSSL=false&serverTimezone=GMT%2B8&rewriteBatchedStatements=true&allowPublicKeyRetrieval=true
jdbc.user=root
jdbc.password=root
启动：mysql -uroot -p（已配置自启动）

redis:
host: 192.168.137.110
port: 6379
启动：/usr/local/tools/redis/bin/redis-server /usr/local/tools/redis/bin/redis.conf
访问：Redis Insight软件查看数据

kafka:
bootstrap-servers: 192.168.137.110:9092
启动：
/app/tools/kafka_2.12-3.9.1/bin/kafka-server-start.sh /app/tools/kafka_2.12-3.9.1/config/server.properties
访问： idea plugins配置后查看


Consul:
D:\2025\java\software\SpringCloud\consul_1.17.1_windows_386
启动：
file:///D:/2025/java/software/SpringCloud/consul_1.17.1_windows_386/consul_start.bat
@echo.服务启动......
@echo off
@sc create Consul binpath= "D:\2025\java\software\SpringCloud\consul_1.17.1_windows_386\consul.exe agent -server -ui -bind=127.0.0.1 -client=0.0.0.0 -bootstrap-expect  1  -data-dir D:\2025\java\software\SpringCloud\consul_1.17.1_windows_386\mydata   "
@net start Consul
@sc config Consul start= AUTO
@echo.Consul start is OK......success
@pause
访问： http://localhost:8500/

Zipkin:
D:\2025\java\software\SpringCloud\zipkin-server-3.0.0-rc0-exec
启动：java -jar zipkin-server-3.0.0-rc0-exec.jar
访问：http://localhost:9411/

Nacos:
D:\2025\java\software\SpringCloud\nacos-server2.2.3\bin
启动：startup.cmd -m standalone
访问：http://localhost:8848/nacos/   nacos/nacos


Sentinel:
启动：D:\2025\java\software\SpringCloud\sentinel-dashboard-1.8.6>java -jar sentinel-dashboard-1.8.6.jar
访问：http://localhost:8080/#/dashboard       sentinel/sentinel
后台默认端口8719

seata:
启动： D:\2025\java\software\SpringCloud\seata-server-2.0.0\bin\seata-server.bat
访问： http://localhost:7091/#/transaction/list  seata/seata




测试：
1. 启动consul + zipkin
MainOpenFeign80 :80/
PaymentMain8001 :8001/
PaymentMain8002 - copy from 8001 :8002/
PaymentMain8003 - copy from 8001 :8003/
GatewayMain9527 :9527/

测试 consul + feign + gateway + loadbalancer
1. http://localhost:80/feign/pay/info   -- 可以测试gateway网关，feign远程调用，load balancer 负载均衡
  1.1 找到cloud-gateway  --》 /pay/info;
  1.2 到cloud-gateway服务，配置了route:pay_routh3，所有请求转到cloud-payment-service
  1.3 最终找到cloud-payment-service --》 com.ityj.cloud.controller.PaymentController.info
2.http://localhost/feign/pay/get/1    -- 测试feign的超时重试
3.http://localhost/feign/pay/consul/config  -- 测试consul配置中心动态刷新


Resilient4j 熔断降级、隔离、限流测试
1.http://localhost/feign/pay/circuit/-4  测试熔断COUNT_BASED
熔断后断路器打开，正常接口也没办法访问http://localhost/feign/pay/circuit/12
2.http://localhost/feign/pay/circuit/9999  测试熔断 TIME_BASED

3. 隔离bulkhead - SEMAPHORE  - 只允许2个并发，其他请求等待1秒直接失败
jemter 并发请求http://localhost/feign/pay/bulkhead/9999
此时所有请求http://localhost/feign/pay/bulkhead/3，等待1秒直接失败fallback
4. 隔离bulkhead - THREADPOOL  - 限制并发
jmeter压测  http://localhost/feign/pay/bulkhead_pool/9999
默认拒绝策略是ThreadPoolBulkheadConfig.rejectedExecutionHandler Abort

5. 限流
http://localhost/feign/pay/ratelimit/3


Cloud Alibaba 测试
启动
NacosConfig3377 :3377/
OrderMain83

Sentinel8401 :8401/
Payment9001 :9001/
Payment9002 - copy from 9001 :9002/
Payment9003 - copy from 9001 :9003/

1. 配置中心动态刷新
http://localhost:3377/config/info
2. 测试nacos注册中心，RestTemplate远程调用。负载均衡
http://localhost:83/consumer/pay/nacos/1

Sentinel测试
1.流控规则
1.1阈值类型 : QPS & 并发线程数
http://localhost:8401/testA

1.2 流控模式
直接：表面的意思
关联： 资源名/testA   关联资源/testB       testB访问量过大会影响testA
http://localhost:8401/testB
链路： 只针对/testC限流， 而不对/testD限流
testC和testD都调用同一个方法。。资源名是common，入口资源是/testC
http://localhost:8401/testC
1.3 流控效果
快速失败
预热：冷启动，前5秒只允许10 / 3 个请求，后续恢复到10个请求
排队等待： 只允许1秒进来10个请求，其他请求进队列等待，最多等1秒。超时直接拒绝。


2. 熔断规则
1.1 熔断策略
 慢调用比例  http://localhost:8401/testF
 异常比例  http://localhost:8401/testG
 异常数  http://localhost:8401/testG

3. 热点规则
必须配置resource
http://localhost:8401/testHotKey?p1=1  对于参数p1=1，只允许1秒1个请求。对于p1不为空的其他值，只允许1秒3个请求。不对其他情况的场景限流。


4. 授权规则
对有serverName参数的请求加黑/白名单
http://localhost:8401/empower?serverName=test
